---
title: "Introducci√≥n al an√°lisis de datos con R"
subtitle: "Curso dirigido a Ciencias Sociales y Humanidades"
author: "Basti√°n Olea Herrera"
format: 
  revealjs:
    theme: [default, estilos.scss]
    transition: slide
    highlight-style: "github-dark"
    # footer: "Basti√°n Olea Herrera ‚Äî [https://bastianolea.rbind.io](https://bastianolea.rbind.io)"
execute: 
  echo: true
  eval: true
editor_options: 
  chunk_output_type: console
---



## Inicio

[Basti√°n Olea Herrera]{.subtitulo}

[bastianolea.rbind.io](https://bastianolea.rbind.io)

:::: {.pad}
Encuentra todo sobre el curso [en este post](https://bastianolea.rbind.io/blog/curso_gratis_r_intro_1/) de mi blog.
::::

:::: {.pad style="max-width: 50%;"}
::: {.boton}
[{{< fa book-open >}} Curso](https://bastianolea.rbind.io/blog/curso_gratis_r_intro_1/)
:::

::: {.boton}
[{{< fa file-code >}} C√≥digo](https://github.com/bastianolea/curso_intro_R_gratis)
:::

::: {.boton}
[{{< fa video >}} Streaming](https://youtube.com/live/A9wtPBEaVvY)
:::

::: {.boton}
[{{< fa chalkboard-user >}} Diapositivas](https://bastianolea.github.io/curso_intro_R_gratis)
:::

::: {.boton}
[{{< fa envelope >}} Contacto](https://bastianolea.rbind.io/contacto/)
:::
::::

:::: {.pad}
Puedes encontrar m√°s contenidos para [aprender R en este sitio](https://bastianolea.github.io/aprende_r/), y m√°s cosas de R [en mi sitio web](https://bastianolea.rbind.io).
::::

----


## ¬øQu√© es R?

:::: {.columns}

::: {.column width="55%"}
R es un lenguaje de programaci√≥n enfocado al **an√°lisis de datos**, las **estad√≠sticas** y la **visualizaci√≥n de datos**.
:::

::: {.column width="45%"}
![](imagenes/logo_r.png){.rosa style="height: 180px; margin-top:-30px;"}
:::
::::

::: {.boton}
[{{< fa circle-arrow-down >}} Descargar R](https://cran.r-project.org/)
:::

<br>

:::: {.fragment}
### ¬øPara qu√© sirve?

::: {.incremental}
- L√≥gica distinta: **instrucciones** en vez de **acciones** ‚öôÔ∏è
- Repetir, mejorar, adaptar y reutilizar lo que ya has hecho ‚ôªÔ∏è
- Automatizar tareas repetitivas ü§ñ
- Expandir tus resultados üöÄ
:::
::::

----


### ¬øPor qu√© usar R?

:::: {.fragment}
::: {.cuadro} 
[Gratuito]{.subtitulo}

R es un lenguaje de programaci√≥n abierto y gratuito, y es parte de la comunidad del _software libre_, as√≠ que nunca tendr√°s que pagar nada!
:::
::::

:::: {.fragment}
::: {.cuadro} 
[Amigable]{.subtitulo}

R fue creado para personas de distintas disciplinas, y al centrarse en los datos resulta [m√°s intuitivo](https://bastianolea.rbind.io/blog/r_introduccion/por_que_r/#usabilidad) que otros lenguajes.
:::
::::

:::: {.fragment}
::: {.cuadro} 
[Reproducible]{.subtitulo}

La gracia de R es [guardar todos los pasos de tu an√°lisis](https://bastianolea.rbind.io/blog/2025-11-13/), lo que facilita corregirlos, [reutilizarlos](https://bastianolea.rbind.io/blog/r_introduccion/por_que_r/#procesos-reutilizables) para nuevos casos, y compartirlo con otros.
:::
::::

----


## ¬øQu√© se puede hacer con R?

<img class="r-stretch" 
src="imagenes/shiny_apps.jpg" 
style="border-radius: 8px; border: solid 1px #442A54; margin-bottom: 20px;"/>

<div style="text-align: center; font-size: 90%;">
Muestra de algunas [aplicaciones](https://bastianolea.github.io/shiny_apps/), [gr√°ficos](https://bastianolea.rbind.io/tags/gr√°ficos/), [tablas](https://bastianolea.rbind.io/tags/tablas/), y [mapas](https://bastianolea.rbind.io/tags/mapas/) hechos con R. Tambi√©n algunos [trabajos](https://bastianolea.rbind.io/blog/portafolio_trabajos_r/) que he hecho.
</div>



----


## Diferencia entre _hacer_ y programar

::: {.incremental}
- Aprender a programar es un **cambio de perspectiva**: pasamos de _hacer_ cosas a _planificar_ cosas üíÖüèº
- Acci√≥n üîß ‚Üí instrucci√≥n üß†
- Trabajamos **desde arriba**, viendo todos sus pasos y componentes üë©üèª‚Äçüíª
- Pasos independientes, reutilizables, mejorables, intercambiables ‚öôÔ∏è
- El trabajo que hagas puede **servirte** a futuro, a ti y a otrxs ‚ôªÔ∏è
- Resultados **replicables** üè≠
:::

::: {.fragment}
Veamos algunos casos!
:::

----

### Caso 1: _arreglar un problema_

::: {.pad}
Datos ‚Üí A ‚Üí B ‚Üí C ‚Üí Resultado
:::

::: {.fragment}

::::: {.columns}

:::: {.column}
[Hacer]{.subtitulo}

::: {.incremental}
- Hago **A**
- Hago **B**
- Hago **C**
- _Me equivoqu√© en **B**_ üò£
- Vuelvo a **A** üôÑ
- Hago **B**
- Hago **C**
::: 
::::

:::: {.column}
[Programar]{.subtitulo}

::: {.incremental}
- Haga **A**
- Haga **B**
- Haga **C**
- _Me equivoqu√© en **B**_ ü§®
- Cambio **B** üòå
- Re-ejecuto **A**, **B** y **C**
::: 
::::
:::::

:::

----


### Caso 2: _actualizaci√≥n de datos_

::: {.pad}
Datos ‚Üí A ‚Üí B ‚Üí C ‚Üí Resultado
:::



::::: {.columns}

:::: {.column}
[Hacer]{.subtitulo}

::: {.incremental}
- *Actualizar datos*
- Hago de nuevo **A**
- Hago de nuevo **B**
- Hago de nuevo **C**
:::

::::

:::: {.column}
[Programar]{.subtitulo}

::: {.incremental}
- *Actualizar datos*
- Re-ejecuto **A**, **B** y **C**
:::

::::
:::::

----



### Caso 3: _optimizar procesamiento o cambio en metodolog√≠a_

::: {.pad}
Datos ‚Üí A ‚Üí B ‚Üí C ‚Üí Resultado
:::

::::: {.columns}

:::: {.column}
[Hacer]{.subtitulo}

::: {.incremental}
- _Cambio en procesamiento/metodolog√≠a_
- Tengo **A**
- Hago de nuevo **B**
- Hago de nuevo **C**
:::

::::

:::: {.column}
[Programar]{.subtitulo}

::: {.incremental}
- _Cambio en procesamiento/metodolog√≠a_
- Ajusto **A** si es conveniente
- Aplico cambios en **B**
- Re-ejecuto **A**, **B** y **C**
:::

::::
:::::

----

### Caso 4: _replicar un resultado_

::: {.pad}
Datos ‚Üí A ‚Üí B ‚Üí C ‚Üí Resultado
:::

::::: {.columns}

:::: {.column}
[Hacer]{.subtitulo}

::: {.incremental}
- Hago **A** para grupo 1
- Hago **B** para grupo 1
- Hago **C** para grupo 1
- Hago **A** para grupo 2 ü§®
- Hago **B** para grupo 2
- Hago **C** para grupo 2... üòµ
:::

::::

:::: {.column}
[Programar]{.subtitulo}

::: {.incremental}
- Hago **A** para grupo 1
- Hago **B** para grupo 1
- Hago **C** para grupo 1
- Ajusto scripts para que funcionen con m√°s grupos
- Re-ejecuto **A**, **B** y **C** para grupo 2
- Re-ejecuto **A**, **B** y **C** para grupo 3
- O mejor, hago un loop que haga **A**, **B** y **C** para todos los grupos üòå
:::

::::
:::::


----


## Diferencia entre R y RStudio

::::: {.columns}

:::: {.column}
::: {.fragment}
#### R
![](imagenes/logo_r.png){.rosa style="height: 128px;"}

- Lenguaje de programaci√≥n
- Lanzado en 1993
- Usado por l√≠nea de comandos
- Desarrollado por R Core Team
- Basado en el lenguaje S (1976)
- Software libre
:::
::::
:::: {.column}

::: {.fragment}

#### RStudio

![](imagenes/logo_rstudio.png){.rosa style="height: 128px;"}

- Entorno de desarrollo integrado (IDE) enfocado en R
- Lanzado en 2011
- Interfaz gr√°fica (ventanas y botones)
- Desarrollado por Posit (ex RStudio)
- Software libre
:::
::::
:::::


:::: aside
::: {.fragment}
_Por favor no digan que "aprendieron RStudio"_ üò£
:::
::::


----

## Conceptos clave

::: {.fragment}
![](imagenes/icono_script.png){.izq style="margin: 10px; width: 110px;"}

#### Script

Archivo de texto .R en el que escribimos nuestro c√≥digo, en pasos, y siguiendo un orden l√≥gico.

<br>
:::

::: {.fragment}
![](imagenes/icono_consola.png){.izq style="margin-top: 10px; width: 130px;"}

#### Consola

Es la forma directa de interactuar con R, un comando a la vez, con resultados ef√≠meros.

<br>
:::

::: {.fragment}
![](imagenes/icono_project.png){.izq style="width: 130px;"}

#### Proyecto

Archivo .Rproj que marca nuestro espacio de trabajo: una carpeta espec√≠fica que re√∫ne todas las piezas de nuestro an√°lisis.
:::


----

## RStudio

::: {.boton .absolute top=-1% right=0%}
[{{< fa circle-arrow-down >}} Descargar RStudio](https://posit.co/download/rstudio-desktop/)
:::

![](imagenes/rstudio.png){.entrada-fade-in .centro style="width: 800px;"}

::: {.fragment}
[1]{.circulo-grande .absolute top=30% left=4%}
[Scripts]{.circulo-grande-texto .absolute top=30% left=4%}
:::

::: {.fragment}
[2]{.circulo-grande .absolute top=70% left=4%}
[Consola]{.circulo-grande-texto .absolute top=70% left=4%}
:::

::: {.fragment}
[3]{.circulo-grande .absolute top=30% right=4%}
[Entorno]{.circulo-grande-texto-der .absolute top=30% right=4%}
:::

::: {.fragment}
[4]{.circulo-grande .absolute top=70% right=4%}
[Archivos]{.circulo-grande-texto-der .absolute top=70% right=4%}
:::

----


### Conceptos

::: {.fragment .pad}
[1]{.circulo} **Panel de scripts:** los archivos de texto con nuestro c√≥digo. Podemos tener varias pesta√±as. Ejecutamos el c√≥digo poniendo el cursor en la l√≠nea y presionando `control + enter`, o el bot√≥n _Run_.
:::

::: {.fragment .pad}
[2]{.circulo} **Panel de consola:** en la consola se imprimen los **resultados** del c√≥digo que ejecutamos. Tambi√©n podemos ejecutar c√≥digo directamente en ella escribiendo y presionando `enter`.
:::

::: {.fragment .pad}
[3]{.circulo} **Panel de entorno:** ac√° veremos los **objetos** que vayamos creando o cargando, que pueden ser n√∫meros, texto, tablas de datos, funciones, gr√°ficos y otros.
:::

::: {.fragment .pad}
[4]{.circulo} **Panel de archivos:** en este panel podemos navegar los archivos y carpetas de nuestro proyecto y/o computador. La idea es que _todo_ est√© dentro del proyecto!
:::


----

### Consola y scripts


![](imagenes/rstudio_script.png){.absolute top=5% right=-20%}



:::: {.columns}

::: {.column}

::: {.incremental}
- Todos los **comandos** se ejecutan por medio de la consola
- Pero al ejecutar c√≥digo en la consola, el c√≥digo no se guarda!
- Para **guardar** el c√≥digo, escribimos en **scripts**
- Escribimos las **instrucciones** en un script, y RStudio se encarga de pasarlos a la consola y ejecutarlos cuando se lo pidamos üí°
:::

:::
::::

----

### Botones 

::::{.r-stack}

::: {.fragment .fondo}
![](imagenes/rstudio_boton_0.png){style="width: 700px;"}

::: {.centrar}
Crear un **nuevo script** de R
:::
:::


::: {.fragment .fondo}
![](imagenes/rstudio_boton_1.png){style="width: 700px;"}

::: {.centrar}
Bot√≥n para **ejecutar c√≥digo**
:::
:::

::: {.fragment .fondo}
![](imagenes/rstudio_boton_2.png){style="width: 700px;"}

::: {.centrar}
Bot√≥n para **ejecutar todo el script**
:::
:::

::: {.fragment .fondo}
![](imagenes/rstudio_boton_3.png){style="width: 700px;"}

::: {.centrar}
Configurar paneles de RStudio
:::
:::

::: {.fragment .fondo}
![](imagenes/rstudio_boton_4.png){style="width: 700px;"}

::: {.centrar}
Cambiar de **proyecto** o crear uno nuevo
:::
:::

::::

----


## Operaciones b√°sicas

::::: {.columns}

:::: {.column style="padding-right:28px;"}

::: {.incremental}
- Podemos realizar cualquier operaci√≥n matem√°tica en R.
- Para **ejecutar** un comando, pon el cursor de texto en la l√≠nea o expresi√≥n que desees ejecutar, o selecci√≥nala, y presiona el bot√≥n _Run_, o las teclas `control + enter`.
- Lo importante es que el cursor de texto `|` est√© en cualquier lugar de la l√≠nea.
- El **resultado** de todas las operaciones aparece en la **consola**.
:::

::::

:::: {.column width="40%"}

::: {.fragment} 

::: {.pad}
```{r}
2 + 2 #suma
```
:::
::: {.pad}
```{r}
50 * 100 #multiplicaci√≥n
```
:::
::: {.pad}
```{r}
4556 - 1000 #resta
```
:::
::: {.pad}
```{r}
6565 / 89 #divisi√≥n
```
:::
::: {.pad}
```{r}
10^4 #potencias
```
:::
:::

::::
:::::


----

### Comentarios

::: {.incremental}
- Los comentarios nos permiten poner texto en cualquier parte del script sin que afecte los c√°lculos.
- Tambi√©n podemos poner un comentario al final de una l√≠nea sin que afecte el c√≥digo
:::


::: {.fragment}
```{r}
#| eval: false
1 + 1 + 1 + 1
# comentario: quiz√°s esto deber√≠a
# ser de otra forma, porque
# la verdad qued√≥ bien mal...

1 * 4 # as√≠ queda mucho mejor
```
:::

----


## Tipos de datos

Lo que podemos hacer siempre va a depender del **tipo** de cada objeto. 

. . .

En R existen varios tipos:

::: {.pad}
**Num√©ricos**
```{r}
#| eval: false
#| code-line-numbers: false
1  2  3  4  5.1  5.2  5.333
```
Pueden ser decimales (_doubles_) o enteros (_integers_)
::: 

. . .

::: {.pad}
**Caracter** (texto)
```{r}
#| eval: false
#| code-line-numbers: false
"√©sta es una cadena de texto"
```
::: 

. . .

::: {.pad}
**L√≥gicos** (verdadero o falso)
```{r}
#| eval: false
#| code-line-numbers: false
TRUE FALSE TRUE
```
::: 


----

## Objetos

Se le llama **objeto** a cualquier dato, variable, o elemento que tengas en R.

Podemos guardar _todo_ como un objeto.

. . . 

Para **crear** un objeto, simplemente le damos un nombre y le _asignamos_ un contenido.

::: {style="max-width: 300px; margin: auto;"}
**nombre** [‚Üê]{style="font-size: 130%;"} _contenido_
:::

<br>

. . . 

:::: {.columns}
::: {.column .just-der }
Para asignar algo a un objeto, usamos el operador `<-`
:::

::: {.column}
```{r style="margin-left: 28px; margin-top:20px;"}
#| code-line-numbers: false
cifra <- 4
```
:::
::::

<br>

. . . 

:::: {.columns}
::: {.column .just-der}
El objeto `cifra` se crea cuando declaramos que va a contener el valor `4`
:::

::: {.column}
```{r style="margin-left: 28px; margin-top:20px;"}
#| code-line-numbers: false
cifra
```
:::
::::


----

### Asignaci√≥n

Con el _operador de **asignaci√≥n**_ creamos objetos nuevos.

::: {.centrar style="font-size: 200%"}
`->`
:::

::: {.fragment}
Se escribe con: 

::: {.centrar style="color: #563A74; opacity: 40%;"}
Windows:
:::

![](imagenes/assignment_shortcut_win.png){.centrar}

::: {.centrar style="color: #563A74; opacity: 40%; margin-top:32px;"}
Mac:
:::

![](imagenes/assignment_shortcut_mac.png){.centrar}

:::

----


:::: {.columns}

::: {.column}
Al asignar algo, **creamos** o **modificamos** un objeto con el valor que le estamos asignando.

Al ejecutar un objeto, obtenemos su valor.
:::

::: {.column}

::: {.fragment}
```{r}
edad <- 32
edad
```
:::

::: {.fragment}
```{r}
animal = "gato"
animal
```
:::

:::
::::

<br>

::: {.fragment}
:::: {.columns}

::: {.column width=40%}

<div style="padding-right:12px;">
Podemos usar el objeto creado para lo que queramos.

Crear objetos es como **asignar variables**, y podemos usar estas variables para llevar a cabo operaciones!
</div>

:::

::: {.column width=60%}


:::: {.columns}

::: {.fragment .column width=49%}
```{r}
edad <- 32
a√±o <- 2026
a√±o - edad
```
:::

::: {.fragment .column width=49%}
```{r}
perros = 2
gatos = 3
perros + gatos
```
:::
::::

::: {.fragment}
```{r}
presupuesto = 100000
pizza = 15000
presupuesto - pizza * 10
```
:::
:::
::::

:::

----

## Comparaciones

Podemos usar cifras u objetos para compararlas entre s√≠: la respuesta ser√° `TRUE` (verdadero) o `FALSE` (falso).

. . .

:::: {.pad style="max-width: 400px;"}

::: {.fragment}
```{r}
edad >= 18
```
:::

::: {.fragment}
```{r}
minimo <- 35
edad > minimo
``` 
:::

::: {.fragment}
```{r}
a√±o == 2024
``` 
:::

::: {.fragment}
```{r}
a√±o != 2024
```
:::
::::

. . .

Las comparaciones son el principio que luego nos permitir√° filtrar datos, crear variables, y m√°s!

----


## Vectores

Los vectores son **secuencias** de elementos. Un objeto que contiene cero o m√°s datos.

::: {.incremental}
- Estos elementos son de un **mismo tipo**: num√©rico, car√°cter o l√≥gico.
- Son la forma m√°s b√°sica de registrar e interactuar con varios datos a la vez.
:::

::: {.fragment}
```{r}
c(1, 2, 3, 4, 5, 6)
c("a", "b", "c", "d")
c(TRUE, FALSE, FALSE)
c(0.2, 0.1, -0.0, -0.1)
```
:::

----

Tambi√©n podemos realizar **comparaciones** sobre los valores de un vector:

```{r}
edades <- c(54, 34, 65, 21, 32)
edades > 40
```

<br> 

O cualquier **operaci√≥n** sobre sus elementos:
```{r}
a√±o <- 2026
a√±os <- a√±o - edades
a√±os
```



----

## Funciones

::: {.incremental}
- Las **funciones** son peque√±os programas que permiten realizar distintas operaciones.
:::

::: {.centrar}
`funci√≥n(argumento = 123)`
:::

::: {.fragment}
Algunas funciones comunes:

```{r}
#| code-line-numbers: false
#| eval: false
mean() # calcular promedio
median() # calcular mediana
sum() # sumar elementos
min() # valor m√≠nimo
max() # valor m√°ximo
typeof() # tipo del objeto
is.na() # evaluar si es missing
as.numeric() # convertir a num√©rico
```
:::

::: aside
::: {.fragment}
Si no sabemos c√≥mo usar una funci√≥n, podemos buscar su nombre en el panel **Ayuda** de RStudio, o escribir el nombre de la funci√≥n precedido de un signo de interrogaci√≥n: `?funcion`
:::
:::

----

#### Funciones en vectores 

Las funciones tambi√©n pueden operar **sobre vectores** de datos.

::: {.pad .fragment}
```{r}
poblaci√≥n <- c(120, 340, 560, 230, 450)
prom_pob <- mean(poblaci√≥n)
prom_pob
```
:::

::: {.fragment}
Es decir que la **operaci√≥n** que hace la funci√≥n se aplica **a cada elemento** del vector.

Pensemos las **funciones** como nuestras **acciones**, y los **vectores** como las columnas o **variables** de nuestras bases de datos.
:::






# Datos {{< fa database >}}

Para cargar datos, tenemos que:

::: {.incremental}
- Tener un **archivo** y conocer su **formato** (Excel, Stata, CSV, etc.)
- [Saber **d√≥nde est√°** el archivo en nuestro computador]{.fragment .strike}
- **Guardar** el archivo dentro del proyecto de R üìÇ
- Conocer una **funci√≥n** que lea ese formato de archivos
:::

## Cargar datos {{< fa file-export >}}

- Las funciones de carga de datos usan como argumento la **ruta** del archivo.

::: {.fragment .pad}
Cargar un archivo en la misma carperta del proyecto:
```{r}
#| eval: false
#| code-line-numbers: false
datos <- read.csv("datos.csv")
```
:::

::: {.fragment .pad}
Cargar un archivo en una subcarpeta del proyecto:
```{r}
#| eval: false
#| code-line-numbers: false
datos <- read.csv("carpeta/datos.csv")
```
:::

<br>

::: {.fragment}
Probemos cargando unos datos!

::: {.boton}
<a href="https://github.com/bastianolea/curso_intro_R_gratis/raw/main/datos/pobreza/estimaciones_pobreza.csv" target="_blank"> {{< fa file-download >}} Descargar datos de pobreza </a>
:::

:::



## Paquetes

:::: {.columns} 

::: {.fragment .column width=60%}
![](imagenes/tidyverse.png)
:::

::: {.column width=40%}

::: {.incremental}
- **Extensiones** de R que te permiten agregar **nuevas** y **mejores** funcionalidades.
- Se instalan desde internet
- Son creados y mantenidos **por la comunidad**
- Se revisan para garantizar su seguridad y estabilidad
:::

::: {.fragment}
```{r}
#| eval: false
#| code-line-numbers: false
install.packages()
```
:::

:::

::::

----

### Paquetes para carga de datos {{< fa laptop-file >}}

![](imagenes/paquetes_carga_datos.png){.pad style="height: 200px;"}


::: {.pad .incremental}
- `{readxl}` es uno de los paquetes de lectura de planillas Excel. Para escribir un archivo Excel est√° `{writexl}`
- `{readr}` lee y escribe datos de m√∫ltiples formatos (csv, rds, rdata), usualmente de forma m√°s veloz y c√≥moda
- `{haven}` permite cargar archivos SPSS, Stata, y SAS
- `{arrow}` es un formato moderno de datos columnares, optimizado para grandes vol√∫menes y velocidad de carga, y pensado para usarse en distintos softwares
:::






# `{dplyr}`


:::: {.columns}
::: {.incremental .column width=70%}
- Paquete de exploraci√≥n, manipulaci√≥n y transformaci√≥n de datos
- Sus funciones se escriben como verbos
- Las acciones se encadenan con el operador de conexi√≥n o _pipe_: `|>`

::: {.fragment}
```{r}
#| message: false
library(dplyr)
```
:::
:::

::: {.column width=30%}
![](imagenes/dplyr.png){}
:::
::::

<br>

::: {.boton .fragment}
[{{< fa file-lines >}} Ver tutorial](https://bastianolea.rbind.io/blog/r_introduccion/dplyr_intro/)
:::


----

## Funciones comunes

::: {.incremental}
- `head()`, `tail()`, `glimpse()`: vistazos a los datos
- `select()`: seleccionar columnas o variables de una tabla
- `slice()`: extraer filas de una tabla por su posici√≥n o distintos criterios
- `pull()`: extraer una columna como vector
- `filter()`: filtrar observaciones en base a condiciones personalizadas
- `distinct()`: filtrar observaciones repetidas en una o m√°s columnas
- `count()`: conteo de casos √∫nicos en una o m√°s columnas
- `mutate()`: crear columnas entregando valores, funciones sobre columnas, o calculando a partir de otras columnas
:::

----


## Tutoriales de `{dplyr}`

Para que puedan repasar o guiarse con **casos b√°sicos de uso** de `{dplyr}` con **datos reales**, dejo un par de tutoriales:

::: {.boton .pad}
[{{< fa file-lines >}} Tutorial con datos censales ](https://bastianolea.rbind.io/blog/r_introduccion/tutorial_dplyr_censo/)
:::

::: {.boton .pad}
[{{< fa file-lines >}} Tutorial con datos sociales](https://bastianolea.rbind.io/blog/r_introduccion/tutorial_dplyr_campamentos/)
:::

----

## Conector

::: {.boton .absolute top=0% right=0%}
[{{< fa file-lines >}} Ver tutorial](https://bastianolea.rbind.io/blog/r_introduccion/conectores/)
:::

El conector o _pipe_ `|>` (o tambi√©n `%>%`) nos permite encadenar varias funciones de forma m√°s legible.

::: {.centrar style="font-size: 200%"}
`|>`  `%>%`
:::

::: {.fragment}
Se escribe con: 

::: {.centrar style="color: #563A74; opacity: 40%;"}
Windows:
:::

![](imagenes/pipe_shortcut_win.png){.centrar}

::: {.centrar style="color: #563A74; opacity: 40%; margin-top:32px;"}
Mac:
:::

![](imagenes/pipe_shortcut_mac.png){.centrar}

:::



----


### Usando el conector
::: {.fragment .pad}
Aplicar una funci√≥n normalmente:
```{r}
#| eval: false
#| code-line-numbers: false
funcion(objeto) # a la funci√≥n le pasamos un objeto
```
:::
::: {.fragment .pad}
Otra forma de hacerlo con `|>` es:
```{r}
#| eval: false
#| code-line-numbers: false
objeto |> funcion() # al objeto luego le aplicamos la funci√≥n
```
:::
::: {.fragment .pad}
Luego podemos encadenar varias funciones:

```{r}
#| eval: false
#| code-line-numbers: false
objeto |> funcion() |> funcion() # al objeto le aplicamos dos funciones
```
:::
::: {.fragment .pad}
Tambi√©n podemos ordenar las instrucciones hacia abajo:
```{r}
#| eval: false
resultado <- objeto |> 
  funcion() |> 
  funcion()
```
:::


----


## Seleccionar y ordenar

::: {.boton .absolute top=-1% right=0%}
[{{< fa file-lines >}} Ver tutorial](https://bastianolea.rbind.io/blog/r_introduccion/dplyr_intro/#datos)
:::

Cargamos un conjunto de datos de prueba:

```{r}
library(dplyr)
library(readr)

datos <- read_csv2("datos/pobreza/estimaciones_pobreza.csv")
```

Estos datos son del [Ministerio Desarrollo Social y Familia](https://bidat.gob.cl/directorio/Pobreza%20comunal/estimaciones-de-pobreza-comunal-2022) de Chile.

<br>

:::: {.columns}

::: {.column .fragment}
#### Seleccionar
```{r}
datos |> 
  select(region, comuna, personas) |> 
  head()
```
::: 

::: {.column .fragment}
#### Ordenar
```{r}
datos |> 
  select(region, comuna, personas) |> 
  arrange(desc(personas)) |> 
  head()
```
:::
::::


----


## Filtrar datos

::: {.boton .absolute top=-1% right=0%}
[{{< fa file-lines >}} Ver tutorial](https://bastianolea.rbind.io/blog/r_introduccion/dplyr_intro/#filtrar-datos)
:::

- Para filtrar, realizamos una **comparaci√≥n** entre los valores de una columna y un valor espec√≠fico.


::: {.fragment}
```{r}
#| message: false
library(dplyr)

datos |> 
  filter(porcentaje > 0.35) |> 
  arrange(desc(porcentaje)) |> 
  head()
```
:::


----



## Crear/modificar variables

::: {.boton .absolute top=0% right=0%}
[{{< fa file-lines >}} Ver tutorial](https://bastianolea.rbind.io/blog/r_introduccion/dplyr_mutate/)
:::

::: {.pad}
Con `mutate()` para crear una nueva variable o columna
:::

::: {.pad}
Le aplicamos `mutate()` a un _data frame_ conectando los datos a la funci√≥n con un conector (`|>` o `%>%`)
:::

:::: {.columns}
::: {.column .fragment}
```{r}
datos |> 
  select(codigo, comuna) |> 
  mutate(saludo = "hola") |> 
  head()
```
:::

::: {.column .fragment}
```{r}
datos |> 
  select(comuna, personas) |> 
  mutate(miles = personas/1000) |> 
  head()
```
:::
::::

----

### Variables condicionales







:::: {.columns}
::: {.column .fragment}
#### `ifelse()`

**Si** ocurre _esto,_ **entonces** retorno _lo primero_, y **si no**, _lo segundo._
```{r}
datos |> 
  select(comuna, porcentaje) |> 
  mutate(nivel = ifelse(
    porcentaje >= 0.3,
    yes = "alta", 
    no = "baja")) |> 
  head()
```
:::

::: {.column .fragment}
#### `case_when()`
Recodificaci√≥n avanzada con **m√∫ltiples condicionales**.
```{r}
datos |> 
  select(comuna, porcentaje) |> 
  mutate(miles = case_when(
    porcentaje >= 0.3 ~ "alta",
    porcentaje >= 0.2 ~ "media",
    porcentaje < 0.2 ~ "baja")) |> 
  head()
```
:::
::::


----

## Res√∫menes de datos

::: {.boton .absolute top=-1% right=0%}
[{{< fa file-lines >}} Ver tutorial](https://bastianolea.rbind.io/blog/r_introduccion/dplyr_summarize/)
:::

::: {.fragment}
Aplicar una **funci√≥n** para **resumir** todas las filas de una tabla en un s√≥lo resultado:

```{r}
datos |> 
  summarize(total = sum(personas))
```
:::

::: {.fragment}
Si **agrupamos** los datos, obtendremos una fila de resultado por cada grupo:

```{r}
datos |> 
  group_by(region) |> 
  summarize(total = sum(personas)) |> 
  head(n = 4)
```
:::


----



## Trabajando con texto

![](imagenes/stringr.png){.esquina-der style='height:128px;'}

El paquete `{stringr}` se especializa en texto.

::: {.pad}
```{r}
library(stringr)
```

::: {.fragment}
```{r}
texto <- "todxs pueden aprender a programar üíï" 

str_detect(texto, "todos")

str_detect(texto, "aprender")
```
:::

::: {.fragment}
```{r}
datos |> 
  filter(str_detect(comuna, "Alto")) |> 
  select(region, comuna)
```
:::
:::



----

## Cruzar datos

::: {.boton .absolute top=0% right=0%}
[{{< fa file-lines >}} Ver tutorial](https://bastianolea.rbind.io/blog/left_join/)
:::

Para cruzar dos tablas de datos<br>usamos `left_join()` de `{dplyr}`

<br>

![](imagenes/left_join.png){.centrar style='max-height: 400px;'}

----


### Cruzando datos {{< fa table >}}

Veamos un ejemplo donde cruzamos dos tablas, la de **pobreza** y una nueva de **clasificaci√≥n comunal** (urbana, mixta, rural seg√∫n la [PNDR](https://bibliotecadigital.odepa.gob.cl/handle/20.500.12650/74476)), a partir de la columna que tienen en com√∫n: `codigo`

::: {.fragment}
```{r}
#| message: false
clasificacion <- readr::read_csv2("datos/clasificacion/clasificacion.csv")
```
:::

::: {.fragment}
```{r}
clasificacion_b <- clasificacion |> 
  select(codigo, clasificacion)
```
:::

::: {.fragment}
```{r}
datos_clasif <- datos |> 
  select(codigo, comuna, personas, porcentaje) |> 
  left_join(clasificacion_b, by = "codigo")

datos_clasif |> head()
```
:::


----


## Datos para practicar {{< fa file-code >}}


::: {.boton}
[{{< fa file-lines >}} Estimaciones de poblaci√≥n Censo](https://raw.githubusercontent.com/bastianolea/curso_intro_R_gratis/refs/heads/main/datos/estimaciones/estimaciones-y-proyecciones-base.xlsx)
:::


::: {.boton }
[{{< fa file-lines >}} Variables educacionales Censo 2024](https://github.com/bastianolea/curso_intro_R_gratis/raw/main/datos/censo/P7_Educacion.xlsx)
:::

::: {.boton }
[{{< fa file-lines >}} Estimaci√≥n de pobreza multidimensional 2022](https://github.com/bastianolea/curso_intro_R_gratis/raw/main/datos/pobreza/estimaciones_indice_pobreza_multidimensional_comunas_2022.xlsx)
:::

Puedes encontrar m√°s datos en mi [repositorio de datos sociales](https://bastianolea.github.io/datos_sociales/), en el [banco integrado de datos del Ministerio de Desarrollo](https://bidat.midesof.cl/), en los [datos abiertos del Estado Chile](https://datos.gob.cl/), y [muchos m√°s](https://bastianolea.rbind.io/blog/r_introduccion/recursos_r/#datos).

:::: aside 
::: {.fragment}
Ahora que ya sabes lo b√°sico, todo lo dem√°s se trata de aprender piezas y herramientas que puedes ir agregando a tus an√°lisis! üß©üõ†Ô∏è
:::
::::

















----



::: {.absolute top=40% style="text-align: center;"}
**¬°Gracias!**

Si tienes dudas o quieres seguir por tu cuenta, [visita este sitio con recursos para aprender R.](https://bastianolea.github.io/aprende_r/)
:::

:::: {.centrar}
::: {.boton}
[{{< fa book-open >}} Curso](https://bastianolea.rbind.io/clases/curso_gratis_r_intro_1/)
:::

::: {.boton}
[{{< fa file-code >}} C√≥digo](https://github.com/bastianolea/curso_intro_R_gratis)
:::

::: {.boton}
[{{< fa video >}} Streaming](https://youtube.com/live/A9wtPBEaVvY)
:::
::::

